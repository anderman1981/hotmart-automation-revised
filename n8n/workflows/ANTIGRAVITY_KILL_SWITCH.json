{
  "name": "ANTIGRAVITY_KILL_SWITCH",
  "nodes": [
    {
      "parameters": {
        "triggerTimes": {
          "item": [{ "mode": "everyX", "value": 4, "unit": "hours" }]
        }
      },
      "name": "CRON_MONITOR",
      "type": "n8n-nodes-base.cron",
      "position": [200, 300]
    },
    {
      "parameters": {
        "url": "http://localhost:4123/health",
        "method": "GET",
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "name": "CHECK_HEALTH",
      "type": "n8n-nodes-base.httpRequest",
      "position": [450, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.status}}",
              "operation": "equal",
              "value2": "OK"
            }
          ]
        }
      },
      "name": "SYSTEM_HEALTHY",
      "type": "n8n-nodes-base.if",
      "position": [700, 300]
    },
    {
      "parameters": {
        "functionCode": "// Sistema saludable - log simple\nconst healthData = items[0].json;\n\nreturn {\n  json: {\n    status: 'healthy',\n    message: '✅ Sistema funcionando correctamente',\n    timestamp: new Date().toISOString(),\n    health: healthData\n  }\n};"
      },
      "name": "LOG_HEALTHY",
      "type": "n8n-nodes-base.function",
      "position": [900, 200]
    },
    {
      "parameters": {
        "functionCode": "// Sistema con problemas - notificar y detener\nconst healthData = items[0].json;\n\n// Si el sistema no está saludable, simplemente loguear el problema\nreturn {\n  json: {\n    status: 'unhealthy',\n    message: '⚠️ Sistema con problemas detectados',\n    timestamp: new Date().toISOString(),\n    health: healthData,\n    action: 'manual_intervention_required'\n  }\n};"
      },
      "name": "LOG_UNHEALTHY",
      "type": "n8n-nodes-base.function",
      "position": [900, 400]
    }
  ],
  "connections": {
    "CRON_MONITOR": {
      "main": [[{ "node": "CHECK_HEALTH", "type": "main", "index": 0 }]]
    },
    "CHECK_HEALTH": {
      "main": [
        [{ "node": "SYSTEM_HEALTHY", "type": "main", "index": 0 }],
        [{ "node": "SYSTEM_HEALTHY", "type": "main", "index": 1 }]
      ]
    },
    "SYSTEM_HEALTHY": {
      "main": [
        [{ "node": "LOG_HEALTHY", "type": "main", "index": 0 }],
        [{ "node": "LOG_UNHEALTHY", "type": "main", "index": 0 }]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  }
}