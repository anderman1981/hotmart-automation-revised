{
  "name": "Hotmart Publication Flow",
  "nodes": [
    {
      "parameters": {
        "path": "manager-event",
        "responseMode": "lastNode",
        "options": {}
      },
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "position": [460, 300]
    },
    {
      "parameters": {
        "functionCode": "// Procesar webhook y publicar en Instagram\nconst baseUrl = 'http://localhost:4123';\nconst data = items[0].json;\n\ntry {\n  // Publicar contenido via Instagram agent\n  const response = await fetch(`${baseUrl}/api/agents/instagram/start`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ \n      source: 'webhook',\n      content: data\n    })\n  });\n  \n  const result = await response.json();\n  \n  return {\n    json: {\n      success: true,\n      message: 'Content published via webhook',\n      result: result,\n      timestamp: new Date().toISOString()\n    }\n  };\n  \n} catch (error) {\n  return {\n    json: {\n      success: false,\n      message: 'Publication failed',\n      error: error.message,\n      timestamp: new Date().toISOString()\n    }\n  };\n}"
      },
      "name": "Process & Publish",
      "type": "n8n-nodes-base.function",
      "position": [680, 300]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [[{ "node": "Process & Publish", "type": "main", "index": 0 }]]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  }
}